{% load static %}
<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>Shopping Cart || Pabna</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico">
        <!-- Place favicon.ico in the root directory -->

		<!-- all css here -->
		<!-- bootstrap v3.3.6 css -->
        <link rel="stylesheet" href={% static 'css/bootstrap.min.css' %}>
		<!-- animate css -->
        <link rel="stylesheet" href={% static 'css/animate.css'%}>
		<!-- jquery-ui.min css -->
        <link rel="stylesheet" href={% static 'css/jquery-ui.min.css' %}>
		<!-- meanmenu css -->
        <link rel="stylesheet" href={% static 'css/meanmenu.min.css' %}>
		<!-- owl.carousel css -->
        <link rel="stylesheet" href={% static 'css/owl.carousel.css' %}>
		<!-- slick css -->
		<link rel="stylesheet" href={% static 'css/slick.css' %}>
		<!-- font-awesome css -->
        <link rel="stylesheet" href={% static 'css/font-awesome.min.css' %}>
		<!-- style css -->
		<link rel="stylesheet" href={% static 'css/style.css' %}>
		<!-- responsive css -->
        <link rel="stylesheet" href={% static 'css/responsive.css' %}>
		<!-- modernizr js -->
        <script src={% static 'js/vendor/modernizr-2.8.3.min.js' %}></script>
    </head>
    <body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <!-- Add your site or application content here -->
		
		<!-- header start -->
        <header class="header-pos">
			<!-- header-bottom-area start -->
			<div class="header-bottom-area">
				<div class="container">
					<div class="inner-container">
						<div class="row">
							<div class="col-md-2 col-sm-4 col-xs-5">
								<div class="logo">
									<a href="index.html"><img src="img/logo-white-text.png" alt="" /></a>
								</div>
							</div>
							<div class="col-md-8 hidden-xs hidden-sm">
								<div class="main-menu">
									<nav>
										<ul>
											<li class="static"><a href={% url 'shop' %}>Catalogo</a>
											</li>
											<li><a href={% url 'shop' %}>Categorias</a>
												<div class="mega-menu mega-menu-2">
													<span>
														<a href="shop.html" class="mega-title">Ropa Para Mujer </a>
														<a href="shop.html">...</a>
														<a href="shop.html">...</a>
														<a href="shop.html">...</a>
														<a href="shop.html">...</a>
													</span>
													<span>
														<a href="shop.html" class="mega-title">Ropa Para Hombre </a>
														<a href="shop.html">...</a>
														<a href="shop.html">...</a>
														<a href="shop.html">...</a>
														<a href="shop.html">...</a>
													</span>
													<span class="mega-menu-img">
														<a href="shop.html"><img alt="" src="img/1.jpg"></a>
													</span>
												</div>
											</li>
											<li><a href={% url 'contact' %}>contactanos</a></li>
										</ul>
									</nav>
								</div>
							</div>
							<div class="col-md-2 col-sm-8 col-xs-7 header-right">
								<div class="my-cart">
									<div class="total-cart">
										<a href="{% url 'ver_carrito' %}">
											<i class="fa fa-shopping-cart"></i>
											<span>{{carro}}</span>
										</a>
									</div>
									<ul>
										{% for item in items %}
											<li class="cart-border">
												<div class="cart-img">
													<a href="{% url 'details' item.producto.id %}"><img alt="" src="{{ item.producto.imagen.url }}"></a>
												</div>
												<div class="cart-info">
													<h4><a href="{% url 'details' item.producto.id %}">{{ item.producto.nombre }}</a></h4>
													<h6><a class="decorar">Precio: $ {{item.producto.precio}} x {{item.cantidad}}</a></h6>
												</div>
											</li>
										{% endfor %}
										<a href="{% url 'ver_carrito' %}">
											<li class="cart-button">
												Ver Carro
											</li>
										</a>
									</ul>
								</div>
								<div class="user-meta">
									<a href="#"><i class="fa fa-cog"></i></a>
									<ul>
										<li><a href="#">My Account</a></li>
										<li><a href="#">Wish list</a></li>
										<li><a href="#">Checkout</a></li>
										<li><a href="#">Log in</a></li>
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- header-bottom-area end -->
			<!-- mobile-menu-area start -->
			<div class="mobile-menu-area visible-xs visible-sm">
				<div class="container">
					<div class="row">
						<div class="col-md-12">
							<div class="mobile-menu">
								<nav id="dropdown">
									<ul>
										<li><a href={% url 'shop' %}>Ropa</a>
											<ul>
												<li><a href="#">WOMEN CLOTH</a>
													<ul>
														<li><a href="shop.html">casual shirt</a></li>
														<li><a href="shop.html">rikke t-shirt</a></li>
														<li><a href="shop.html">mia top </a></li>
														<li><a href="shop.html">muscle tee</a></li>
													</ul>
												</li>
												<li><a href="#">MEN CLOTH</a>
													<ul>
														<li><a href="shop.html">casual shirt</a></li>
														<li><a href="shop.html">rikke t-shirt</a></li>
														<li><a href="shop.html">mia top </a></li>
														<li><a href="shop.html">muscle tee</a></li>
													</ul>
												</li>
												<li><a href="#">WOMEN JEWELRY</a>
													<ul>
														<li><a href="shop.html">necklace </a></li>
														<li><a href="shop.html">chunky short striped</a></li>
														<li><a href="shop.html">samhar cuff </a></li>
														<li><a href="shop.html">nail set</a></li>
													</ul>
												</li>											
											</ul>
										</li>
										<li><a href={% url 'contact' %}>Contactanos</a></li>
									</ul>
								</nav>
							</div>					
						</div>
					</div>
				</div>
			</div>
			<!-- mobile-menu-area end -->				
		</header>
		<!-- header end -->
		<!-- breadcrumb-area start -->
		<div class="breadcrumb-area">
			<div class="container">
				<div class="row">
					<div class="col-md-12">
						<div class="breadcrumb-list">
							<h1>Carrito De Compras</h1>
							<ul>
								<li><a href={% url 'index' %}>Inicio</a> <span class="divider">|</span></li>
								<li>Carrito De Compras</li>
							</ul>							
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- breadcrumb-area end -->
		<!-- cart-main-area start -->
<div class="cart-main-area">
    <div class="container">
        <div class="row">
            <div class="col-md-12 col-sm-12 col-xs-12">
                <form action="#" method="post">
                    {% csrf_token %}
                    <div class="table-content table-responsive">
						{% for item in items %}
									<div class="container2">
										<a href="#"><img alt="" src="{{ item.producto.imagen.url }}" width="70px" ></a>
										<p class="Titulo">{{item.producto.nombre}}</p>
										<p class="descripcion">{{item.producto.descripcion}}</p>
										<p class="descripcion">{{item.producto.precio}} x {{item.cantidad}}</p>
										<p><a href="{% url 'quitar_del_carrito' item.producto.id %}">Eliminar</a></p>
									</div>
						{% endfor %}
                                
						<br><br>
                    </div>
					<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
					<script>
						$(document).ready(function () {
							$('input[name^="cantidad-"]').on('change', function () {
								var itemId = $(this).attr('name').split('-')[1];
								var nuevaCantidad = parseInt($(this).val());
					
								$.ajax({
									url: '{% url "actualizar_carrito" %}',
									method: 'POST',
									data: {
										'itemId': itemId,
										'cantidad': nuevaCantidad,
										'csrfmiddlewaretoken': '{{ csrf_token }}'
									},
									success: function (data) {
										if ('subtotal' in data && 'total' in data) {
											// Actualizar el subtotal en la interfaz
											$('#subtotal-' + itemId).text(data.subtotal);
											
											// Actualizar el total en el formulario
											$('#total').text(data.total);

											$('#subtotal2').text(data.total)
										} else if ('error' in data) {
											console.error(data.error);
										}
									},
									error: function (error) {
										console.error('Error:', error);
									}
								});
							});
						});
					</script>
					
                    <div class="row">
                        <div class="col-md-8 col-sm-7 col-xs-12">
                            <div class="buttons-cart">
                                <input type="submit" value="Actualizar Carro" />
                                <a href="{% url 'shop' %}">Continuar Comprando</a>
                            </div>
                        </div>
                        <div class="col-md-4 col-sm-5 col-xs-12">
                            <div class="cart_totals">
                                <h2>Totales Compra</h2><br>
                                <table>
                                    <tbody>
                                        <tr class="cart-subtotal">
                                            <th >Subtotal</th>
                                            <td><span class="amount" id="subtotal2">${{ total }}</span></td>
                                        </tr>
                                        <tr class="order-total">
                                            <th >Total</th>
                                            <td>
                                                <strong><span class="amount" id="total">${{ total }}</span></strong>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table><br>
                                <div class="wc-proceed-to-checkout"><br>
                                    <a href="{% url 'check' %}">Adquirir Articulos</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- cart-main-area end -->
		
		<!-- footer start -->
		<footer>
			<div class="footer-top">
				<div class="container">
					<div class="row">
						<div class="col-md-12">
							<div class="footer-logo">
								<img src="img/logo-white-text.png" alt="" />
								<p>🫣 Encuentra tu estilo, siéntete imparable y conquista el mundo con cada atuendo. ¡Tu ropa, tu historia, tu poder! ✌️</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<!-- footer-top-area start -->
			<div class="footer-top-area">
				<div class="container">
					<div class="row">
						<!-- footer-widget start -->
						<div class="col-lg-3 col-md-3 col-sm-4">
							<div class="footer-widget">
								<h3>CONTACT US</h3>
								<ul class="footer-contact">
									<li>
										<i class="fa fa-envelope"> </i>	
										Email: admin@BasicTheme.com
									</li>
									<li>
										<i class="fa fa-phone"> </i>
										Phone: +123 455657589
									</li>
								</ul>
							</div>
						</div>
						<!-- footer-widget end -->											
					</div>
				</div>
			</div>
			<!-- footer-top-area end -->
			<!-- footer-bottom-area start -->
			<div class="footer-bottom-area">
				<div class="container">
					<div class="row">
						<div class="col-lg-6 col-md-6 col-sm-6">
							<div class="copyright">
								<p>Copyright © <a href="#">Pabna</a>. All Rights Reserved</p>
							</div>
						</div>
						<div class="col-lg-6 col-md-6 col-sm-6">
							
						</div>
					</div>
				</div>
			</div>
			<!-- footer-bottom-area end -->			
		</footer>
		<!-- footer end -->
		


<!-- Modal -->
<div class="modal fade" id="productModal" tabindex="-1" role="dialog" aria-labelledby="productModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="productModalLabel">Modal title</h4>
      </div>
      <div class="modal-body">
        Marley tried to convince her but she was not interestedMarley tried to convince her but she was not interestedMarley tried to convince her but she was not interestedMarley tried to convince her but she was not interestedMarley tried to convince her but she was not interestedMarley tried to convince her but she was not interestedMarley tried to convince her but she was not interestedMarley tried to convince her but she was not interestedMarley tried to convince her but she was not interestedMarley tried to convince her but she was not interestedMarley tried to convince her but she was not interestedMarley tried to convince her but she was not interestedMarley tried to convince her but she was not interestedMarley tried to convince her but she was not interested
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>	

		<!-- all js here -->
		<!-- jquery latest version -->
        <script src={% static 'js/vendor/jquery-1.12.0.min.js' %}></script>
		<!-- bootstrap js -->
        <script src={% static 'js/bootstrap.min.js' %}></script>
		<!-- owl.carousel js -->
        <script src={% static 'js/owl.carousel.min.js' %}></script>
		<!-- meanmenu js -->
        <script src={% static 'js/jquery.meanmenu.js' %}></script>
		<!-- jquery-ui js -->
        <script src={% static 'js/jquery-ui.min.js' %}></script>
		<!-- wow js -->
        <script src={% static 'js/wow.min.js' %}></script>
		<!-- plugins js -->
        <script src={% static 'js/plugins.js' %}></script>
		<!-- main js -->
        <script src={% static 'js/main.js' %}></script>
    </body>
</html>
